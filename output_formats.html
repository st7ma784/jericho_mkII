

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Output Formats &mdash; Jericho Mk II 2.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=51b770b3"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Architecture and Design" href="architecture.html" />
    <link rel="prev" title="Running Simulations" href="running_simulations.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Jericho Mk II
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#prerequisites">Prerequisites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#hardware-requirements">Hardware Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#software-requirements">Software Requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#step-1-install-cuda-toolkit">Step 1: Install CUDA Toolkit</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#step-2-install-mpi-for-multi-gpu">Step 2: Install MPI (for Multi-GPU)</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#step-3-clone-and-build-jericho-mk-ii">Step 3: Clone and Build Jericho Mk II</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#running-your-first-simulation">Running Your First Simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#single-gpu-example">Single GPU Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#multi-gpu-example">Multi-GPU Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#understanding-the-configuration-file">Understanding the Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#visualizing-results">Visualizing Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#basic-visualization-with-python">Basic Visualization with Python</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#quick-reference-common-commands">Quick Reference: Common Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#next-steps">Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#gpu-not-detected">GPU Not Detected</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#mpi-errors">MPI Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#out-of-memory">Out of Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#performance-issues">Performance Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#getting-help">Getting Help</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#configuration-file-structure">Configuration File Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#simulation-section">Simulation Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#domain-section">Domain Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#mpi-section">MPI Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#cuda-section">CUDA Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#particles-section">Particles Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#fields-section">Fields Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#boundaries-section">Boundaries Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#physics-section">Physics Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#output-section">Output Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#diagnostics-section">Diagnostics Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#complete-example">Complete Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#validation-and-testing">Validation and Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="running_simulations.html">Running Simulations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="running_simulations.html#basic-usage">Basic Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#single-gpu-simulation">Single GPU Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#command-line-options">Command Line Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="running_simulations.html#multi-gpu-simulations">Multi-GPU Simulations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#mpi-basics">MPI Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#gpu-assignment">GPU Assignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#multi-node-simulations">Multi-Node Simulations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="running_simulations.html#output-files">Output Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#file-structure">File Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#field-output-files">Field Output Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#particle-output-files">Particle Output Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#diagnostics-csv">Diagnostics CSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#checkpoints">Checkpoints</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="running_simulations.html#visualization">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#quick-plots-with-python">Quick Plots with Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#paraview-visualization">ParaView Visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="running_simulations.html#monitoring-and-diagnostics">Monitoring and Diagnostics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#real-time-monitoring">Real-Time Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#check-energy-conservation">Check Energy Conservation</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#performance-monitoring">Performance Monitoring</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="running_simulations.html#common-simulation-scenarios">Common Simulation Scenarios</a><ul>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#magnetic-reconnection">Magnetic Reconnection</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#kelvin-helmholtz-instability">Kelvin-Helmholtz Instability</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#solar-wind-interaction">Solar Wind Interaction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="running_simulations.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#simulation-crashes">Simulation Crashes</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_simulations.html#unexpected-results">Unexpected Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="running_simulations.html#best-practices">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="running_simulations.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Output Formats</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#field-output-files">Field Output Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#file-naming-convention">File Naming Convention</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdf5-structure">HDF5 Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#field-datasets">Field Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reading-field-files-in-python">Reading Field Files in Python</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#particle-output-files">Particle Output Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">File Naming Convention</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">HDF5 Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#particle-datasets">Particle Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reading-particle-files-in-python">Reading Particle Files in Python</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#diagnostics-csv-file">Diagnostics CSV File</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#file-structure">File Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#columns">Columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reading-diagnostics-in-python">Reading Diagnostics in Python</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#checkpoint-files">Checkpoint Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">File Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restarting-from-checkpoint">Restarting from Checkpoint</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-analysis-examples">Data Analysis Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#compute-derived-quantities">Compute Derived Quantities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time-series-analysis">Time Series Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spatial-analysis">Spatial Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exporting-to-other-formats">Exporting to Other Formats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#convert-to-vtk-paraview">Convert to VTK (ParaView)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#convert-to-netcdf">Convert to NetCDF</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture and Design</a><ul>
<li class="toctree-l2"><a class="reference internal" href="architecture.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html#hybrid-pic-mhd-physics">Hybrid PIC-MHD Physics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#governing-equations">Governing Equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#why-hybrid">Why Hybrid?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html#numerical-methods">Numerical Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#particle-in-cell-algorithm">Particle-in-Cell Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#boris-particle-pusher">Boris Particle Pusher</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#current-advance-method-cam">Current Advance Method (CAM)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html#gpu-architecture">GPU Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#structure-of-arrays-soa">Structure of Arrays (SoA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#cuda-kernel-design">CUDA Kernel Design</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html#mpi-cuda-hybrid-parallelism">MPI+CUDA Hybrid Parallelism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#domain-decomposition">Domain Decomposition</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#ghost-cell-exchange">Ghost Cell Exchange</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#particle-migration">Particle Migration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html#memory-management">Memory Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#gpu-memory-hierarchy">GPU Memory Hierarchy</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#memory-allocation-strategy">Memory Allocation Strategy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html#code-organization">Code Organization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#module-structure">Module Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#build-system">Build System</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html#testing-strategy">Testing Strategy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#unit-tests">Unit Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#integration-tests">Integration Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#performance-benchmarks">Performance Benchmarks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html#key-performance-metrics">Key Performance Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cuda_kernels.html">CUDA Kernels</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cuda_kernels.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="cuda_kernels.html#kernel-design-principles">Kernel Design Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="cuda_kernels.html#particle-kernels">Particle Kernels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#particle-push-kernel">Particle Push Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#bilinear-interpolation">Bilinear Interpolation</a></li>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#boris-rotation">Boris Rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#particle-to-grid-kernels">Particle-to-Grid Kernels</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cuda_kernels.html#field-solver-kernels">Field Solver Kernels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#ohm-s-law-kernel">Ohm’s Law Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#faraday-s-law-kernel">Faraday’s Law Kernel</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cuda_kernels.html#boundary-condition-kernels">Boundary Condition Kernels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#periodic-boundaries">Periodic Boundaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#reflecting-boundaries">Reflecting Boundaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#outflow-boundaries">Outflow Boundaries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cuda_kernels.html#diagnostic-kernels">Diagnostic Kernels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#kinetic-energy-kernel">Kinetic Energy Kernel</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cuda_kernels.html#performance-optimization">Performance Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#memory-access-patterns">Memory Access Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#shared-memory-usage">Shared Memory Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#occupancy-tuning">Occupancy Tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#kernel-fusion">Kernel Fusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cuda_kernels.html#profiling-and-debugging">Profiling and Debugging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#using-nvprof">Using nvprof</a></li>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#using-nsight-compute">Using Nsight Compute</a></li>
<li class="toctree-l3"><a class="reference internal" href="cuda_kernels.html#cuda-memcheck">CUDA-MEMCHECK</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cuda_kernels.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mpi_parallelism.html">MPI Parallelism</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mpi_parallelism.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpi_parallelism.html#why-mpi">Why MPI?</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpi_parallelism.html#domain-decomposition">Domain Decomposition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#cartesian-grid-partitioning">Cartesian Grid Partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#neighbor-identification">Neighbor Identification</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#ghost-cells">Ghost Cells</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mpi_parallelism.html#communication-patterns">Communication Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#ghost-cell-exchange">Ghost Cell Exchange</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#cuda-aware-mpi">CUDA-Aware MPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#particle-migration">Particle Migration</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#collective-operations">Collective Operations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mpi_parallelism.html#load-balancing">Load Balancing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#static-load-balancing">Static Load Balancing</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#dynamic-load-balancing-experimental">Dynamic Load Balancing (Experimental)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mpi_parallelism.html#performance-optimization">Performance Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#overlap-communication-and-computation">Overlap Communication and Computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#cuda-aware-mpi-with-gpudirect-rdma">CUDA-Aware MPI with GPUDirect RDMA</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#minimize-ghost-cell-width">Minimize Ghost Cell Width</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mpi_parallelism.html#scaling-studies">Scaling Studies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#weak-scaling">Weak Scaling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#strong-scaling">Strong Scaling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#scaling-limits">Scaling Limits</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mpi_parallelism.html#debugging-mpi-programs">Debugging MPI Programs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#common-issues">Common Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#debugging-tools">Debugging Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi_parallelism.html#testing-mpi">Testing MPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mpi_parallelism.html#best-practices">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpi_parallelism.html#configuration-example">Configuration Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpi_parallelism.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/particle_buffer.html">API Reference: ParticleBuffer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/particle_buffer.html#class-jericho-particlebuffer">Class: <code class="docutils literal notranslate"><span class="pre">jericho::ParticleBuffer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/particle_buffer.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/particle_buffer.html#header-file">Header File</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/particle_buffer.html#class-declaration">Class Declaration</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/particle_buffer.html#constructors">Constructors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/particle_buffer.html#particlebuffer-size-t-initial-capacity-int-device-id-0">ParticleBuffer(size_t initial_capacity, int device_id = 0)</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/particle_buffer.html#particlebuffer">~ParticleBuffer()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/particle_buffer.html#member-functions">Member Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/particle_buffer.html#memory-management">Memory Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/particle_buffer.html#allocate-size-t-capacity">allocate(size_t capacity)</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/particle_buffer.html#destroy">destroy()</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/particle_buffer.html#resize-size-t-new-capacity">resize(size_t new_capacity)</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/particle_buffer.html#compact">compact()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/particle_buffer.html#particle-operations">Particle Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/particle_buffer.html#add-particle-double-px-double-py-double-pvx-double-pvy-double-pweight-uint8-t-ptype">add_particle(double px, double py, double pvx, double pvy, double pweight, uint8_t ptype)</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/particle_buffer.html#remove-particle-size-t-idx">remove_particle(size_t idx)</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/particle_buffer.html#add-particles-batch">add_particles_batch(…)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/particle_buffer.html#data-transfer">Data Transfer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/particle_buffer.html#copy-to-device">copy_to_device(…)</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/particle_buffer.html#copy-to-host">copy_to_host(…)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/particle_buffer.html#accessors">Accessors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/particle_buffer.html#get-count">get_count()</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/particle_buffer.html#get-capacity">get_capacity()</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/particle_buffer.html#get-memory-bytes">get_memory_bytes()</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/particle_buffer.html#print-stats">print_stats()</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/particle_buffer.html#helper-functions">Helper Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/particle_buffer.html#initialize-uniform">initialize_uniform(…)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/particle_buffer.html#usage-examples">Usage Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/particle_buffer.html#example-1-basic-usage">Example 1: Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/particle_buffer.html#example-2-particle-migration">Example 2: Particle Migration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/particle_buffer.html#performance-notes">Performance Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/particle_buffer.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/fields.html">API Reference: Field Arrays</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/fields.html#quick-reference">Quick Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/fields.html#key-features">Key Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/fields.html#data-members">Data Members</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/fields.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/boundaries.html">API Reference: Boundary Conditions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/boundaries.html#boundary-types">Boundary Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/boundaries.html#periodic-boundaries">Periodic Boundaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/boundaries.html#outflow-boundaries">Outflow Boundaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/boundaries.html#inflow-boundaries">Inflow Boundaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/boundaries.html#reflecting-boundaries">Reflecting Boundaries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/boundaries.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/boundaries.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/mpi_manager.html">API Reference: MPI Manager</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/mpi_manager.html#quick-reference">Quick Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/mpi_manager.html#key-features">Key Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/mpi_manager.html#data-members">Data Members</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/mpi_manager.html#key-methods">Key Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/mpi_manager.html#domain-decomposition">Domain Decomposition</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/mpi_manager.html#communication">Communication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/mpi_manager.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/mpi_manager.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="performance_tuning.html">Performance Tuning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="performance_tuning.html#performance-overview">Performance Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#target-performance-metrics">Target Performance Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#typical-performance">Typical Performance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="performance_tuning.html#configuration-tuning">Configuration Tuning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#timestep-selection">Timestep Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#particles-per-cell">Particles Per Cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#grid-resolution">Grid Resolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#output-cadence">Output Cadence</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="performance_tuning.html#cuda-optimization">CUDA Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#threads-per-block">Threads Per Block</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#memory-pool-size">Memory Pool Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#gpu-selection">GPU Selection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="performance_tuning.html#mpi-optimization">MPI Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#domain-decomposition">Domain Decomposition</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#cuda-aware-mpi">CUDA-Aware MPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#overlap-communication">Overlap Communication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="performance_tuning.html#profiling-and-analysis">Profiling and Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#using-nvidia-smi">Using nvidia-smi</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#using-nvprof">Using nvprof</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#using-nsight-systems">Using Nsight Systems</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="performance_tuning.html#memory-usage-optimization">Memory Usage Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#estimate-memory-requirements">Estimate Memory Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#reduce-memory-usage">Reduce Memory Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="performance_tuning.html#common-performance-issues">Common Performance Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#slow-particle-push">Slow Particle Push</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#slow-particle-to-grid">Slow Particle-to-Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#poor-mpi-scaling">Poor MPI Scaling</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tuning.html#high-memory-usage">High Memory Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="performance_tuning.html#best-practices-summary">Best Practices Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance_tuning.html#performance-checklist">Performance Checklist</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance_tuning.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#build-issues">Build Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#nvcc-not-found">“nvcc not found”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#compute-capability-mismatch">“compute capability mismatch”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#mpi-not-found">“MPI not found”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#hdf5-not-found">“HDF5 not found”</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#runtime-issues">Runtime Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#cuda-out-of-memory">“CUDA out of memory”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#no-cuda-capable-device">“No CUDA-capable device”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#mpi-init-failed">“MPI_Init failed”</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#physics-issues">Physics Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#energy-not-conserved">Energy Not Conserved</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#no-magnetic-reconnection">No Magnetic Reconnection</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#particles-escaping-domain">Particles Escaping Domain</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#nan-values-appearing">NaN Values Appearing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#performance-issues">Performance Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#simulation-too-slow">Simulation Too Slow</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#poor-mpi-scaling">Poor MPI Scaling</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#gpu-thermal-throttling">GPU Thermal Throttling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#output-issues">Output Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#permission-denied-writing-output">“Permission denied” Writing Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#output-files-corrupted">Output Files Corrupted</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#diagnostic-collection">Diagnostic Collection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#before-reporting-issues">Before Reporting Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#getting-help">Getting Help</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#self-help-resources">Self-Help Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#reporting-bugs">Reporting Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#community-support">Community Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#quick-checks">Quick Checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#common-mistakes">Common Mistakes</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citation and Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="citation.html#how-to-cite">How to Cite</a><ul>
<li class="toctree-l3"><a class="reference internal" href="citation.html#bibtex-entry">BibTeX Entry</a></li>
<li class="toctree-l3"><a class="reference internal" href="citation.html#published-papers">Published Papers</a></li>
<li class="toctree-l3"><a class="reference internal" href="citation.html#acknowledgments">Acknowledgments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="citation.html#contributing">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="citation.html#types-of-contributions">Types of Contributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="citation.html#getting-started">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="citation.html#code-style">Code Style</a></li>
<li class="toctree-l3"><a class="reference internal" href="citation.html#documentation">Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="citation.html#testing">Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="citation.html#pull-request-guidelines">Pull Request Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="citation.html#reporting-bugs">Reporting Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="citation.html#requesting-features">Requesting Features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="citation.html#code-of-conduct">Code of Conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="citation.html#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="citation.html#credits">Credits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="citation.html#core-developers">Core Developers</a></li>
<li class="toctree-l3"><a class="reference internal" href="citation.html#id1">Acknowledgments</a></li>
<li class="toctree-l3"><a class="reference internal" href="citation.html#third-party-libraries">Third-Party Libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="citation.html#contact">Contact</a></li>
<li class="toctree-l2"><a class="reference internal" href="citation.html#funding">Funding</a></li>
<li class="toctree-l2"><a class="reference internal" href="citation.html#publications-using-jericho-mk-ii">Publications Using Jericho Mk II</a></li>
<li class="toctree-l2"><a class="reference internal" href="citation.html#see-also">See Also</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Jericho Mk II</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Output Formats</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/output_formats.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="output-formats">
<h1>Output Formats<a class="headerlink" href="#output-formats" title="Link to this heading"></a></h1>
<p>This document describes the output file formats produced by Jericho Mk II and how to work with them.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>Jericho Mk II produces three types of output:</p>
<ol class="arabic simple">
<li><p><strong>Field files</strong> - Electromagnetic fields on grid (HDF5)</p></li>
<li><p><strong>Particle files</strong> - Particle positions and velocities (HDF5)</p></li>
<li><p><strong>Diagnostics</strong> - Time series of integrated quantities (CSV)</p></li>
<li><p><strong>Checkpoints</strong> - Full simulation state for restart (HDF5)</p></li>
</ol>
<p>All spatial data uses <strong>SI units</strong> unless otherwise noted.</p>
</section>
<section id="field-output-files">
<h2>Field Output Files<a class="headerlink" href="#field-output-files" title="Link to this heading"></a></h2>
<section id="file-naming-convention">
<h3>File Naming Convention<a class="headerlink" href="#file-naming-convention" title="Link to this heading"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fields_NNNNNN.h5

where NNNNNN is the timestep number (zero-padded to 6 digits)

Examples:
fields_000000.h5  - Initial conditions (t=0)
fields_000100.h5  - After 100 timesteps
fields_001000.h5  - After 1000 timesteps
</pre></div>
</div>
</section>
<section id="hdf5-structure">
<h3>HDF5 Structure<a class="headerlink" href="#hdf5-structure" title="Link to this heading"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fields_001000.h5
├── Ex              [Dataset: (ny, nx), float64]
├── Ey              [Dataset: (ny, nx), float64]
├── Bz              [Dataset: (ny, nx), float64]
├── density         [Dataset: (ny, nx), float64]
├── current_x       [Dataset: (ny, nx), float64]
├── current_y       [Dataset: (ny, nx), float64]
├── time            [Scalar: float64]
├── step            [Scalar: int32]
└── metadata        [Group]
    ├── nx          [Scalar: int32]
    ├── ny          [Scalar: int32]
    ├── x_min       [Scalar: float64]
    ├── x_max       [Scalar: float64]
    ├── y_min       [Scalar: float64]
    ├── y_max       [Scalar: float64]
    └── units       [Group]
        ├── Ex      [String: &quot;V/m&quot;]
        ├── Ey      [String: &quot;V/m&quot;]
        ├── Bz      [String: &quot;T&quot;]
        ├── density [String: &quot;m^-3&quot;]
        └── current [String: &quot;A/m^2&quot;]
</pre></div>
</div>
</section>
<section id="field-datasets">
<h3>Field Datasets<a class="headerlink" href="#field-datasets" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 15.0%" />
<col style="width: 20.0%" />
<col style="width: 15.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Dataset</p></th>
<th class="head"><p>Shape</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Ex</span></code></p></td>
<td><p>(ny, nx)</p></td>
<td><p>V/m</p></td>
<td><p>Electric field, x-component</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Ey</span></code></p></td>
<td><p>(ny, nx)</p></td>
<td><p>V/m</p></td>
<td><p>Electric field, y-component</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Bz</span></code></p></td>
<td><p>(ny, nx)</p></td>
<td><p>T (Tesla)</p></td>
<td><p>Magnetic field, z-component (2.5D assumption)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">density</span></code></p></td>
<td><p>(ny, nx)</p></td>
<td><p>m⁻³</p></td>
<td><p>Total number density (all species)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">current_x</span></code></p></td>
<td><p>(ny, nx)</p></td>
<td><p>A/m²</p></td>
<td><p>Current density, x-component</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">current_y</span></code></p></td>
<td><p>(ny, nx)</p></td>
<td><p>A/m²</p></td>
<td><p>Current density, y-component</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">temperature</span></code></p></td>
<td><p>(ny, nx)</p></td>
<td><p>K</p></td>
<td><p>Ion temperature (if enabled)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pressure</span></code></p></td>
<td><p>(ny, nx)</p></td>
<td><p>Pa</p></td>
<td><p>Ion pressure (if enabled)</p></td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> Array indexing is <code class="docutils literal notranslate"><span class="pre">[y_index,</span> <span class="pre">x_index]</span></code> (row-major order).</p>
</section>
<section id="reading-field-files-in-python">
<h3>Reading Field Files in Python<a class="headerlink" href="#reading-field-files-in-python" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">h5py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">read_fields</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read field data from HDF5 file.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># Read field arrays</span>
        <span class="n">Ex</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;Ex&#39;</span><span class="p">][:]</span>
        <span class="n">Ey</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;Ey&#39;</span><span class="p">][:]</span>
        <span class="n">Bz</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;Bz&#39;</span><span class="p">][:]</span>
        <span class="n">density</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">][:]</span>

        <span class="c1"># Read metadata</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][()]</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">][()]</span>
        <span class="n">nx</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;metadata/nx&#39;</span><span class="p">][()]</span>
        <span class="n">ny</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;metadata/ny&#39;</span><span class="p">][()]</span>
        <span class="n">x_min</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;metadata/x_min&#39;</span><span class="p">][()]</span>
        <span class="n">x_max</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;metadata/x_max&#39;</span><span class="p">][()]</span>
        <span class="n">y_min</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;metadata/y_min&#39;</span><span class="p">][()]</span>
        <span class="n">y_max</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;metadata/y_max&#39;</span><span class="p">][()]</span>

    <span class="c1"># Create coordinate arrays</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;Ex&#39;</span><span class="p">:</span> <span class="n">Ex</span><span class="p">,</span> <span class="s1">&#39;Ey&#39;</span><span class="p">:</span> <span class="n">Ey</span><span class="p">,</span> <span class="s1">&#39;Bz&#39;</span><span class="p">:</span> <span class="n">Bz</span><span class="p">,</span> <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="n">density</span><span class="p">,</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">,</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span> <span class="n">step</span>
    <span class="p">}</span>

<span class="c1"># Usage</span>
<span class="n">fields</span> <span class="o">=</span> <span class="n">read_fields</span><span class="p">(</span><span class="s1">&#39;output/fields_001000.h5&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ion gyroperiods&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Grid shape: </span><span class="si">{</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;Bz&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Plot magnetic field</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;Bz&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
           <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                   <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>
           <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bz [T]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Magnetic Field at t=</span><span class="si">{</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="particle-output-files">
<h2>Particle Output Files<a class="headerlink" href="#particle-output-files" title="Link to this heading"></a></h2>
<section id="id1">
<h3>File Naming Convention<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>particles_NNNNNN.h5

Examples:
particles_000000.h5  - Initial particles
particles_000100.h5  - After 100 timesteps
</pre></div>
</div>
</section>
<section id="id2">
<h3>HDF5 Structure<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>particles_001000.h5
├── H+              [Group]
│   ├── x           [Dataset: (n_particles,), float64]
│   ├── y           [Dataset: (n_particles,), float64]
│   ├── vx          [Dataset: (n_particles,), float64]
│   ├── vy          [Dataset: (n_particles,), float64]
│   ├── weight      [Dataset: (n_particles,), float64]
│   └── metadata    [Group]
│       ├── charge  [Scalar: float64]
│       ├── mass    [Scalar: float64]
│       └── count   [Scalar: int64]
├── O+              [Group]
│   └── ... (same structure)
├── time            [Scalar: float64]
└── step            [Scalar: int32]
</pre></div>
</div>
</section>
<section id="particle-datasets">
<h3>Particle Datasets<a class="headerlink" href="#particle-datasets" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Dataset</p></th>
<th class="head"><p>Shape</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
<td><p>(n,)</p></td>
<td><p>m</p></td>
<td><p>Particle x positions</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">y</span></code></p></td>
<td><p>(n,)</p></td>
<td><p>m</p></td>
<td><p>Particle y positions</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vx</span></code></p></td>
<td><p>(n,)</p></td>
<td><p>m/s</p></td>
<td><p>Particle x velocities</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vy</span></code></p></td>
<td><p>(n,)</p></td>
<td><p>m/s</p></td>
<td><p>Particle y velocities</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">weight</span></code></p></td>
<td><p>(n,)</p></td>
<td><p>dimensionless</p></td>
<td><p>Statistical weight (macroparticle multiplicity)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="reading-particle-files-in-python">
<h3>Reading Particle Files in Python<a class="headerlink" href="#reading-particle-files-in-python" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">read_particles</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="s1">&#39;H+&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read particle data from HDF5 file.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># Check if species exists</span>
        <span class="k">if</span> <span class="n">species</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Available species: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Species &#39;</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">)</span>

        <span class="c1"># Read particle arrays</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s1">/x&#39;</span><span class="p">][:]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s1">/y&#39;</span><span class="p">][:]</span>
        <span class="n">vx</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s1">/vx&#39;</span><span class="p">][:]</span>
        <span class="n">vy</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s1">/vy&#39;</span><span class="p">][:]</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s1">/weight&#39;</span><span class="p">][:]</span>

        <span class="c1"># Read metadata</span>
        <span class="n">charge</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s1">/metadata/charge&#39;</span><span class="p">][()]</span>
        <span class="n">mass</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s1">/metadata/mass&#39;</span><span class="p">][()]</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][()]</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">][()]</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;vx&#39;</span><span class="p">:</span> <span class="n">vx</span><span class="p">,</span> <span class="s1">&#39;vy&#39;</span><span class="p">:</span> <span class="n">vy</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="n">weight</span><span class="p">,</span>
        <span class="s1">&#39;charge&#39;</span><span class="p">:</span> <span class="n">charge</span><span class="p">,</span> <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="n">mass</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">,</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span> <span class="n">step</span>
    <span class="p">}</span>

<span class="c1"># Usage</span>
<span class="n">particles</span> <span class="o">=</span> <span class="n">read_particles</span><span class="p">(</span><span class="s1">&#39;output/particles_001000.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;H+&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of H+ particles: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">particles</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean velocity: vx=</span><span class="si">{</span><span class="n">particles</span><span class="p">[</span><span class="s1">&#39;vx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>

<span class="c1"># Phase space plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">particles</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">particles</span><span class="p">[</span><span class="s1">&#39;vx&#39;</span><span class="p">],</span>
           <span class="n">gridsize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">mincnt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Particle count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;vx [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;H+ Phase Space at t=</span><span class="si">{</span><span class="n">particles</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="diagnostics-csv-file">
<h2>Diagnostics CSV File<a class="headerlink" href="#diagnostics-csv-file" title="Link to this heading"></a></h2>
<section id="file-structure">
<h3>File Structure<a class="headerlink" href="#file-structure" title="Link to this heading"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>diagnostics.csv
</pre></div>
</div>
<p>Contains time series data with comma-separated values:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>step,time,kinetic_energy,em_energy,total_energy,energy_change,momentum_x,momentum_y,n_particles
0,0.000000e+00,4.532e-11,1.234e-12,4.655e-11,0.000e+00,1.234e-20,-5.678e-21,6553600
100,1.000000e+00,4.534e-11,1.232e-12,4.657e-11,2.000e-15,1.235e-20,-5.679e-21,6553600
200,2.000000e+00,4.536e-11,1.230e-12,4.659e-11,4.000e-15,1.236e-20,-5.680e-21,6553605
...
</pre></div>
</div>
</section>
<section id="columns">
<h3>Columns<a class="headerlink" href="#columns" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">step</span></code></p></td>
<td><p>integer</p></td>
<td><p>Timestep number</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">time</span></code></p></td>
<td><p>ion gyroperiods</p></td>
<td><p>Simulation time</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kinetic_energy</span></code></p></td>
<td><p>J (Joules)</p></td>
<td><p>Total kinetic energy of all particles</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">em_energy</span></code></p></td>
<td><p>J</p></td>
<td><p>Electromagnetic field energy</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">total_energy</span></code></p></td>
<td><p>J</p></td>
<td><p>Sum of kinetic and EM energy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">energy_change</span></code></p></td>
<td><p>J</p></td>
<td><p>Change from initial energy</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">momentum_x</span></code></p></td>
<td><p>kg·m/s</p></td>
<td><p>Total momentum, x-component</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">momentum_y</span></code></p></td>
<td><p>kg·m/s</p></td>
<td><p>Total momentum, y-component</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">n_particles</span></code></p></td>
<td><p>integer</p></td>
<td><p>Total active particle count</p></td>
</tr>
</tbody>
</table>
</section>
<section id="reading-diagnostics-in-python">
<h3>Reading Diagnostics in Python<a class="headerlink" href="#reading-diagnostics-in-python" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="k">def</span><span class="w"> </span><span class="nf">read_diagnostics</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;output/diagnostics.csv&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read diagnostics CSV file.&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Usage</span>
<span class="n">diag</span> <span class="o">=</span> <span class="n">read_diagnostics</span><span class="p">()</span>

<span class="c1"># Plot energy conservation</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Absolute energy</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">diag</span><span class="p">[</span><span class="s1">&#39;kinetic_energy&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kinetic&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">diag</span><span class="p">[</span><span class="s1">&#39;em_energy&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;EM&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">diag</span><span class="p">[</span><span class="s1">&#39;total_energy&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy [J]&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Energy Evolution&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Relative energy change</span>
<span class="n">E0</span> <span class="o">=</span> <span class="n">diag</span><span class="p">[</span><span class="s1">&#39;total_energy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">rel_change</span> <span class="o">=</span> <span class="p">(</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;total_energy&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">E0</span><span class="p">)</span> <span class="o">/</span> <span class="n">E0</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">rel_change</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;±1%&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [ion gyroperiods]&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ΔE/E₀ [%]&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Relative Energy Change&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;energy_conservation.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Check energy conservation</span>
<span class="n">max_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rel_change</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum energy error: </span><span class="si">{</span><span class="n">max_error</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">max_error</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✓ Energy conservation PASSED (&lt;1%)&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✗ Energy conservation FAILED (&gt;1%)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  → Consider reducing timestep dt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="checkpoint-files">
<h2>Checkpoint Files<a class="headerlink" href="#checkpoint-files" title="Link to this heading"></a></h2>
<section id="id3">
<h3>File Structure<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>checkpoint_NNNNNN.h5
</pre></div>
</div>
<p>Contains complete simulation state for restart:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>checkpoint_001000.h5
├── fields              [Group]
│   ├── Ex              [Dataset: (ny, nx), float64]
│   ├── Ey              [Dataset: (ny, nx), float64]
│   ├── Bz              [Dataset: (ny, nx), float64]
│   └── ... (all fields)
├── particles           [Group]
│   ├── H+              [Group]
│   │   ├── x           [Dataset]
│   │   └── ... (all particle data)
│   └── O+              [Group]
├── mpi_state           [Group] (multi-GPU only)
│   ├── rank
│   ├── size
│   └── decomposition
├── config              [Group]
│   └── ... (copy of configuration)
└── metadata            [Group]
    ├── time
    ├── step
    └── version
</pre></div>
</div>
</section>
<section id="restarting-from-checkpoint">
<h3>Restarting from Checkpoint<a class="headerlink" href="#restarting-from-checkpoint" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Restart from checkpoint</span>
./jericho_mkII<span class="w"> </span>--restart<span class="w"> </span>checkpoints/checkpoint_001000.h5<span class="w"> </span>config.toml
</pre></div>
</div>
<p><strong>Notes:</strong></p>
<ul class="simple">
<li><p>Original config file still required</p></li>
<li><p>Simulation continues from checkpoint time/step</p></li>
<li><p>Output directory must be writable</p></li>
<li><p>MPI decomposition must match checkpoint</p></li>
</ul>
</section>
</section>
<section id="data-analysis-examples">
<h2>Data Analysis Examples<a class="headerlink" href="#data-analysis-examples" title="Link to this heading"></a></h2>
<section id="compute-derived-quantities">
<h3>Compute Derived Quantities<a class="headerlink" href="#compute-derived-quantities" title="Link to this heading"></a></h3>
<p><strong>Magnetic field magnitude:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_field_magnitude</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">read_fields</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="c1"># For 2.5D: B = Bz (only z-component)</span>
    <span class="n">B_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;Bz&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">B_mag</span>
</pre></div>
</div>
<p><strong>Electric field magnitude:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_E_magnitude</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">read_fields</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">E_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;Ex&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;Ey&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">E_mag</span>
</pre></div>
</div>
<p><strong>Current density magnitude:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_current_magnitude</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">read_fields</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">J_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;current_x&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;current_y&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">J_mag</span>
</pre></div>
</div>
<p><strong>Particle kinetic energy distribution:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_energy_distribution</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="s1">&#39;H+&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">particles</span> <span class="o">=</span> <span class="n">read_particles</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">species</span><span class="p">)</span>

    <span class="c1"># Kinetic energy per particle</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">particles</span><span class="p">[</span><span class="s1">&#39;vx&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">particles</span><span class="p">[</span><span class="s1">&#39;vy&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">KE</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">particles</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">v2</span>

    <span class="c1"># Weight by macroparticle multiplicity</span>
    <span class="n">hist</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">KE</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">particles</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">hist</span><span class="p">,</span> <span class="n">edges</span>
</pre></div>
</div>
</section>
<section id="time-series-analysis">
<h3>Time Series Analysis<a class="headerlink" href="#time-series-analysis" title="Link to this heading"></a></h3>
<p><strong>Fourier analysis of energy:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">analyze_energy_spectrum</span><span class="p">(</span><span class="n">diag</span><span class="p">):</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.fft</span><span class="w"> </span><span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">fftfreq</span>

    <span class="c1"># FFT of energy signal</span>
    <span class="n">energy</span> <span class="o">=</span> <span class="n">diag</span><span class="p">[</span><span class="s1">&#39;total_energy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">fft_energy</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="n">fftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">energy</span><span class="p">),</span> <span class="n">d</span><span class="o">=</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">diag</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Power spectrum</span>
    <span class="n">power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft_energy</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># Plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">power</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">power</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [1/ion gyroperiod]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Energy Spectrum&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Particle count evolution:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_particle_evolution</span><span class="p">(</span><span class="n">diag</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">diag</span><span class="p">[</span><span class="s1">&#39;n_particles&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [ion gyroperiods]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of particles&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Particle Count Evolution&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Check for particle loss/gain</span>
    <span class="n">n0</span> <span class="o">=</span> <span class="n">diag</span><span class="p">[</span><span class="s1">&#39;n_particles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_final</span> <span class="o">=</span> <span class="n">diag</span><span class="p">[</span><span class="s1">&#39;n_particles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">change</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_final</span> <span class="o">-</span> <span class="n">n0</span><span class="p">)</span> <span class="o">/</span> <span class="n">n0</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Particle count change: </span><span class="si">{</span><span class="n">change</span><span class="si">:</span><span class="s2">+.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="spatial-analysis">
<h3>Spatial Analysis<a class="headerlink" href="#spatial-analysis" title="Link to this heading"></a></h3>
<p><strong>Line plots along axes:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_field_lineout</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;Bz&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">read_fields</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
        <span class="c1"># Find nearest y index</span>
        <span class="n">iy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">position</span><span class="p">))</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="n">iy</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;x [m]&#39;</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># axis == &#39;y&#39;</span>
        <span class="n">ix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">position</span><span class="p">))</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">field</span><span class="p">][:,</span> <span class="n">ix</span><span class="p">]</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;y [m]&#39;</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s1"> lineout along </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s1"> at </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>2D histograms:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_2d_histogram</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="s1">&#39;H+&#39;</span><span class="p">):</span>
    <span class="n">particles</span> <span class="o">=</span> <span class="n">read_particles</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">species</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># Real space</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">particles</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">particles</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
               <span class="n">gridsize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">mincnt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Real Space&#39;</span><span class="p">)</span>

    <span class="c1"># Velocity space</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">particles</span><span class="p">[</span><span class="s1">&#39;vx&#39;</span><span class="p">],</span> <span class="n">particles</span><span class="p">[</span><span class="s1">&#39;vy&#39;</span><span class="p">],</span>
               <span class="n">gridsize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">mincnt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;vx [m/s]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;vy [m/s]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Velocity Space&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="exporting-to-other-formats">
<h2>Exporting to Other Formats<a class="headerlink" href="#exporting-to-other-formats" title="Link to this heading"></a></h2>
<section id="convert-to-vtk-paraview">
<h3>Convert to VTK (ParaView)<a class="headerlink" href="#convert-to-vtk-paraview" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyevtk.hl</span><span class="w"> </span><span class="kn">import</span> <span class="n">gridToVTK</span>

<span class="k">def</span><span class="w"> </span><span class="nf">export_to_vtk</span><span class="p">(</span><span class="n">input_h5</span><span class="p">,</span> <span class="n">output_vtk</span><span class="p">):</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">read_fields</span><span class="p">(</span><span class="n">input_h5</span><span class="p">)</span>

    <span class="c1"># Create coordinate arrays (cell-centered)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># 2D data</span>

    <span class="c1"># Export (note: VTK uses point data, so we need to reshape)</span>
    <span class="n">gridToVTK</span><span class="p">(</span><span class="n">output_vtk</span><span class="p">,</span>
             <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span>
             <span class="n">pointData</span><span class="o">=</span><span class="p">{</span>
                 <span class="s1">&#39;Ex&#39;</span><span class="p">:</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;Ex&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;Ey&#39;</span><span class="p">:</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;Ey&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;Bz&#39;</span><span class="p">:</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;Bz&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">]</span>
             <span class="p">})</span>

<span class="c1"># Usage</span>
<span class="n">export_to_vtk</span><span class="p">(</span><span class="s1">&#39;output/fields_001000.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;output/fields_001000&#39;</span><span class="p">)</span>
<span class="c1"># Creates: fields_001000.vtr (open in ParaView)</span>
</pre></div>
</div>
</section>
<section id="convert-to-netcdf">
<h3>Convert to NetCDF<a class="headerlink" href="#convert-to-netcdf" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">netCDF4</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span>

<span class="k">def</span><span class="w"> </span><span class="nf">export_to_netcdf</span><span class="p">(</span><span class="n">input_h5</span><span class="p">,</span> <span class="n">output_nc</span><span class="p">):</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">read_fields</span><span class="p">(</span><span class="n">input_h5</span><span class="p">)</span>

    <span class="c1"># Create NetCDF file</span>
    <span class="n">nc</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">output_nc</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;NETCDF4&#39;</span><span class="p">)</span>

    <span class="c1"># Define dimensions</span>
    <span class="n">nc</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]))</span>
    <span class="n">nc</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]))</span>

    <span class="c1"># Create coordinate variables</span>
    <span class="n">x_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,))</span>
    <span class="n">y_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,))</span>
    <span class="n">x_var</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
    <span class="n">y_var</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>

    <span class="c1"># Create field variables</span>
    <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Ex&#39;</span><span class="p">,</span> <span class="s1">&#39;Ey&#39;</span><span class="p">,</span> <span class="s1">&#39;Bz&#39;</span><span class="p">,</span> <span class="s1">&#39;density&#39;</span><span class="p">]:</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">))</span>
        <span class="n">var</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>

    <span class="n">nc</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="running_simulations.html"><span class="doc">Running Simulations</span></a> - How to generate output</p></li>
<li><p><a class="reference internal" href="configuration.html"><span class="doc">Configuration Reference</span></a> - Configure output options</p></li>
<li><p>Example Python scripts in <code class="docutils literal notranslate"><span class="pre">scripts/</span></code> directory</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="running_simulations.html" class="btn btn-neutral float-left" title="Running Simulations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="architecture.html" class="btn btn-neutral float-right" title="Architecture and Design" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Lancaster University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>