<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jericho Mk II - Real-time Visualization</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0e27;
            color: #e0e0e0;
            overflow: hidden;
        }

        #header {
            background: linear-gradient(135deg, #1a1f3a 0%, #2d3561 100%);
            padding: 15px 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #4a5588;
        }

        #header h1 {
            font-size: 24px;
            color: #66d9ef;
            text-shadow: 0 0 10px rgba(102, 217, 239, 0.5);
        }

        #status {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #666;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }

        .status-indicator.running {
            background: #4caf50;
            box-shadow: 0 0 15px rgba(76, 175, 80, 0.8);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        #container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 10px;
            padding: 10px;
            height: calc(100vh - 80px);
        }

        .panel {
            background: #1a1f3a;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            border: 1px solid #2d3561;
            display: flex;
            flex-direction: column;
        }

        .panel h2 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #66d9ef;
            border-bottom: 1px solid #2d3561;
            padding-bottom: 8px;
        }

        .canvas-container {
            flex: 1;
            position: relative;
            background: #0a0e27;
            border-radius: 4px;
            overflow: hidden;
        }

        canvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #4a5588 0%, #5d6ba8 100%);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        button:hover {
            background: linear-gradient(135deg, #5d6ba8 0%, #7080c8 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        button:active {
            transform: translateY(0);
        }

        select, input {
            background: #0a0e27;
            border: 1px solid #4a5588;
            color: #e0e0e0;
            padding: 8px;
            border-radius: 4px;
            font-size: 12px;
        }

        .colorbar {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 80%;
            background: linear-gradient(to top, #000080, #0000ff, #00ffff, #00ff00, #ffff00, #ff0000);
            border-radius: 4px;
            border: 1px solid #4a5588;
        }

        #diagnostics-chart {
            width: 100%;
            height: 100%;
        }

        .legend {
            display: flex;
            gap: 15px;
            font-size: 11px;
            margin-top: 5px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .legend-color {
            width: 20px;
            height: 3px;
            border-radius: 2px;
        }

        #connection-status {
            position: fixed;
            top: 80px;
            right: 20px;
            background: rgba(255, 152, 0, 0.9);
            padding: 10px 20px;
            border-radius: 4px;
            display: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        #connection-status.connected {
            background: rgba(76, 175, 80, 0.9);
        }

        .info-overlay {
            position: absolute;
            bottom: 5px;
            left: 5px;
            background: rgba(10, 14, 39, 0.8);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <div id="header">
        <h1>‚ö° Jericho Mk II - Real-time Plasma Simulation</h1>
        <div id="status">
            <div class="status-item">
                <div class="status-indicator" id="sim-status"></div>
                <span id="sim-status-text">Idle</span>
            </div>
            <div class="status-item">
                <span>Step: <strong id="current-step">0</strong></span>
            </div>
            <div class="status-item">
                <span>Time: <strong id="current-time">0.00</strong> s</span>
            </div>
        </div>
    </div>

    <div id="connection-status">Connecting...</div>

    <div id="container">
        <!-- Electromagnetic Fields -->
        <div class="panel">
            <h2>üåä Electromagnetic Fields</h2>
            <div class="controls">
                <select id="field-select">
                    <option value="E_magnitude">|E| Electric Field</option>
                    <option value="B_magnitude">|B| Magnetic Field</option>
                    <option value="Ex">Ex Component</option>
                    <option value="Ey">Ey Component</option>
                    <option value="Bz" selected>Bz Component</option>
                    <option value="current_density">|J| Current Density</option>
                    <option value="charge_density">œÅ Charge Density</option>
                </select>
                <button onclick="toggleFieldVectors()">Toggle Vectors</button>
            </div>
            <div class="canvas-container">
                <canvas id="field-canvas"></canvas>
                <div class="colorbar"></div>
                <div class="info-overlay" id="field-info">Waiting for data...</div>
            </div>
        </div>

        <!-- Particle Distribution -->
        <div class="panel">
            <h2>‚öõÔ∏è Particle Distribution</h2>
            <div class="controls">
                <select id="particle-color">
                    <option value="type">Color by Type</option>
                    <option value="velocity">Color by Velocity</option>
                    <option value="vx">Color by Vx</option>
                    <option value="vy">Color by Vy</option>
                </select>
                <button onclick="toggleParticleTrails()">Toggle Trails</button>
            </div>
            <div class="canvas-container">
                <canvas id="particle-canvas"></canvas>
                <div class="info-overlay" id="particle-info">Particles: 0</div>
            </div>
        </div>

        <!-- Energy Diagnostics -->
        <div class="panel">
            <h2>üìä Energy & Diagnostics</h2>
            <div class="canvas-container">
                <canvas id="diagnostics-canvas"></canvas>
            </div>
            <div class="legend" id="diagnostics-legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #66d9ef;"></div>
                    <span>Total Energy</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #a6e22e;"></div>
                    <span>Kinetic Energy</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #f92672;"></div>
                    <span>Field Energy</span>
                </div>
            </div>
        </div>

        <!-- Phase Space -->
        <div class="panel">
            <h2>üîÑ Phase Space (Vx-Vy)</h2>
            <div class="controls">
                <select id="phase-color">
                    <option value="density">Density</option>
                    <option value="velocity">Velocity</option>
                </select>
            </div>
            <div class="canvas-container">
                <canvas id="phase-canvas"></canvas>
                <div class="info-overlay" id="phase-info">Phase space distribution</div>
            </div>
        </div>

        <!-- Current Density -->
        <div class="panel">
            <h2>‚ö° Current Density |J|</h2>
            <div class="controls">
                <select id="current-component">
                    <option value="magnitude">|J| Magnitude</option>
                    <option value="Jx">Jx Component</option>
                    <option value="Jy">Jy Component</option>
                    <option value="Jz">Jz Component</option>
                </select>
            </div>
            <div class="canvas-container">
                <canvas id="current-canvas"></canvas>
                <div class="colorbar"></div>
                <div class="info-overlay" id="current-info">Current density from particle motion</div>
            </div>
        </div>

        <!-- Plasma Flow -->
        <div class="panel">
            <h2>üåä Plasma Flow Velocity</h2>
            <div class="controls">
                <button onclick="toggleStreamlines()">Toggle Streamlines</button>
                <select id="flow-overlay">
                    <option value="speed">Flow Speed</option>
                    <option value="vorticity">Vorticity</option>
                </select>
            </div>
            <div class="canvas-container">
                <canvas id="flow-canvas"></canvas>
                <div class="info-overlay" id="flow-info">Bulk plasma velocity field</div>
            </div>
        </div>

        <!-- Charge Density -->
        <div class="panel">
            <h2>‚öõÔ∏è Charge Density œÅ</h2>
            <div class="controls">
                <button onclick="toggleChargeContours()">Toggle Contours</button>
            </div>
            <div class="canvas-container">
                <canvas id="charge-canvas"></canvas>
                <div class="colorbar"></div>
                <div class="info-overlay" id="charge-info">Net charge density (ions - electrons)</div>
            </div>
        </div>

        <!-- Pressure & Temperature -->
        <div class="panel">
            <h2>üå°Ô∏è Plasma Pressure</h2>
            <div class="controls">
                <select id="pressure-type">
                    <option value="thermal">Thermal Pressure</option>
                    <option value="magnetic">Magnetic Pressure</option>
                    <option value="total">Total Pressure</option>
                    <option value="beta">Plasma Œ≤</option>
                </select>
            </div>
            <div class="canvas-container">
                <canvas id="pressure-canvas"></canvas>
                <div class="colorbar"></div>
                <div class="info-overlay" id="pressure-info">P = nkT (thermal pressure)</div>
            </div>
        </div>

        <!-- Boundary Conditions -->
        <div class="panel">
            <h2>üî≤ Boundary Fluxes</h2>
            <div class="canvas-container">
                <canvas id="boundary-canvas"></canvas>
                <div class="info-overlay" id="boundary-info">
                    <span style="color: #a6e22e;">‚Üì Inflow</span> | 
                    <span style="color: #f92672;">‚Üë Outflow</span> | 
                    <span style="color: #66d9ef;">‚Üî Periodic</span>
                </div>
            </div>
        </div>
    </div>

    <script src="static/visualization.js"></script>
</body>
</html>
